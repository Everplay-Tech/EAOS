# NOTE: This file contains placeholder secrets for development.
# For production, use Sealed Secrets or external secret management (e.g., HashiCorp Vault, AWS Secrets Manager)

# IMPORTANT: DO NOT commit real secrets to version control!
# Replace all placeholder values with actual secrets before deploying.

# Application Secrets
---
apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
  namespace: biowerk
  labels:
    app: biowerk
type: Opaque
stringData:
  jwt_secret_key: "REPLACE_WITH_ACTUAL_JWT_SECRET"  # Generate with: openssl rand -hex 32

# PostgreSQL Secrets
---
apiVersion: v1
kind: Secret
metadata:
  name: postgres-secret
  namespace: biowerk
  labels:
    app: postgres
type: Opaque
stringData:
  username: "biowerk"
  password: "REPLACE_WITH_ACTUAL_PASSWORD"  # Generate with: openssl rand -base64 32

# MongoDB Secrets
---
apiVersion: v1
kind: Secret
metadata:
  name: mongodb-secret
  namespace: biowerk
  labels:
    app: mongodb
type: Opaque
stringData:
  username: "biowerk"
  password: "REPLACE_WITH_ACTUAL_PASSWORD"  # Generate with: openssl rand -base64 32

# LLM API Keys
---
apiVersion: v1
kind: Secret
metadata:
  name: llm-secrets
  namespace: biowerk
  labels:
    app: biowerk
type: Opaque
stringData:
  openai_api_key: ""  # Optional: Add if using OpenAI
  anthropic_api_key: ""  # Optional: Add if using Anthropic
  deepseek_api_key: ""  # Optional: Add if using DeepSeek

# GDPR Service Secrets
---
apiVersion: v1
kind: Secret
metadata:
  name: gdpr-secrets
  namespace: biowerk
  labels:
    app: gdpr
type: Opaque
stringData:
  encryption_master_key: "REPLACE_WITH_ACTUAL_MASTER_KEY"  # Generate with: openssl rand -hex 32

# Grafana Secrets
---
apiVersion: v1
kind: Secret
metadata:
  name: grafana-secrets
  namespace: biowerk
  labels:
    app: grafana
type: Opaque
stringData:
  admin_user: "admin"
  admin_password: "REPLACE_WITH_ACTUAL_PASSWORD"  # Generate with: openssl rand -base64 16
  secret_key: "REPLACE_WITH_ACTUAL_SECRET_KEY"  # Generate with: openssl rand -hex 32

# TLS Certificates (Optional - for HTTPS)
---
apiVersion: v1
kind: Secret
metadata:
  name: tls-certs
  namespace: biowerk
  labels:
    app: mesh
type: kubernetes.io/tls
stringData:
  tls.crt: |
    -----BEGIN CERTIFICATE-----
    # REPLACE WITH ACTUAL TLS CERTIFICATE
    -----END CERTIFICATE-----
  tls.key: |
    -----BEGIN PRIVATE KEY-----
    # REPLACE WITH ACTUAL PRIVATE KEY
    -----END PRIVATE KEY-----

# Monitoring Exporter Secrets
---
apiVersion: v1
kind: Secret
metadata:
  name: postgres-exporter-secret
  namespace: biowerk
  labels:
    app: postgres-exporter
type: Opaque
stringData:
  data_source_name: "postgresql://biowerk:REPLACE_WITH_ACTUAL_PASSWORD@postgres.biowerk.svc.cluster.local:5432/biowerk?sslmode=disable"

---
apiVersion: v1
kind: Secret
metadata:
  name: mongodb-exporter-secret
  namespace: biowerk
  labels:
    app: mongodb-exporter
type: Opaque
stringData:
  mongodb_uri: "mongodb://biowerk:REPLACE_WITH_ACTUAL_PASSWORD@mongodb.biowerk.svc.cluster.local:27017/biowerk"

---
apiVersion: v1
kind: Secret
metadata:
  name: pgbouncer-exporter-secret
  namespace: biowerk
  labels:
    app: pgbouncer-exporter
type: Opaque
stringData:
  database_url: "postgresql://biowerk:REPLACE_WITH_ACTUAL_PASSWORD@pgbouncer.biowerk.svc.cluster.local:6432/pgbouncer?sslmode=disable"

# Alertmanager Configuration (contains sensitive webhook URLs)
---
apiVersion: v1
kind: Secret
metadata:
  name: alertmanager-config
  namespace: biowerk
  labels:
    app: alertmanager
type: Opaque
stringData:
  alertmanager.yml: |
    global:
      resolve_timeout: 5m
      smtp_smarthost: 'smtp.gmail.com:587'
      smtp_from: 'REPLACE_WITH_EMAIL'
      smtp_auth_username: 'REPLACE_WITH_EMAIL'
      smtp_auth_password: 'REPLACE_WITH_PASSWORD'

    route:
      group_by: ['alertname', 'cluster', 'service']
      group_wait: 10s
      group_interval: 10s
      repeat_interval: 12h
      receiver: 'default'
      routes:
        - match:
            severity: critical
          receiver: 'critical'
        - match:
            team: database
          receiver: 'database-team'

    receivers:
      - name: 'default'
        email_configs:
          - to: 'REPLACE_WITH_TEAM_EMAIL'
            send_resolved: true

      - name: 'critical'
        email_configs:
          - to: 'REPLACE_WITH_ONCALL_EMAIL'
            send_resolved: true
        # Optionally add Slack/PagerDuty webhooks:
        # slack_configs:
        #   - api_url: 'REPLACE_WITH_SLACK_WEBHOOK'
        #     channel: '#critical-alerts'
        # pagerduty_configs:
        #   - service_key: 'REPLACE_WITH_PAGERDUTY_KEY'

      - name: 'database-team'
        email_configs:
          - to: 'REPLACE_WITH_DATABASE_TEAM_EMAIL'
            send_resolved: true

# Backup Service Secrets (for S3/cloud storage)
---
apiVersion: v1
kind: Secret
metadata:
  name: backup-secrets
  namespace: biowerk
  labels:
    app: backup-orchestrator
type: Opaque
stringData:
  s3_bucket: ""  # Optional: S3 bucket name for backups
  aws_access_key_id: ""  # Optional: AWS credentials
  aws_secret_access_key: ""  # Optional: AWS credentials

---
# Instructions for Sealed Secrets (Recommended for Production)
#
# 1. Install Sealed Secrets controller:
#    kubectl apply -f https://github.com/bitnami-labs/sealed-secrets/releases/download/v0.24.0/controller.yaml
#
# 2. Install kubeseal CLI:
#    brew install kubeseal  # or download from GitHub releases
#
# 3. Create a sealed secret:
#    echo -n "my-secret-value" | kubectl create secret generic my-secret --dry-run=client --from-file=key=/dev/stdin -o yaml | \
#    kubeseal -o yaml > sealed-secret.yaml
#
# 4. Apply the sealed secret:
#    kubectl apply -f sealed-secret.yaml
#
# The sealed secret can be safely committed to version control!
