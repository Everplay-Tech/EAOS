# OWASP ZAP API Scan Configuration
# Enterprise-grade API security testing for BIOwerk microservices

# ====================
# API Scan Settings
# ====================
-config api.scan.maxDepth=10
-config api.scan.maxChildren=20

# ====================
# Request Configuration
# ====================
# Set custom headers for API requests
-config replacer.full_list(0).enabled=true
-config replacer.full_list(0).matchtype=REQ_HEADER
-config replacer.full_list(0).matchstring=Accept
-config replacer.full_list(0).replacement=application/json

-config replacer.full_list(1).enabled=true
-config replacer.full_list(1).matchtype=REQ_HEADER
-config replacer.full_list(1).matchstring=Content-Type
-config replacer.full_list(1).replacement=application/json

# ====================
# Active Scan for APIs
# ====================
-config ascan.policy=API-Minimal
-config ascan.strength=MEDIUM
-config ascan.threadPerHost=5

# ====================
# Scan Rules for REST APIs
# ====================
# SQL Injection
-config rules.sqli.enabled=true
-config rules.sqli.strength=MEDIUM

# XSS Protection
-config rules.xss.enabled=true
-config rules.xss.strength=MEDIUM

# Path Traversal
-config rules.pathtraversal.enabled=true

# Remote File Inclusion
-config rules.remotefileinclude.enabled=true

# Command Injection
-config rules.cmdinjection.enabled=true

# CSRF Token Checking
-config rules.csrf.enabled=true

# Insecure HTTP Methods
-config rules.httpmethods.enabled=true

# Server Error Disclosure
-config rules.servererror.enabled=true

# ====================
# API-Specific Tests
# ====================
# Test for parameter pollution
-config rules.parameterpollution.enabled=true

# Test for mass assignment
-config rules.massassignment.enabled=true

# Test for excessive data exposure
-config rules.excessivedataexposure.enabled=true

# ====================
# Rate Limiting
# ====================
-config rules.ratelimiting.enabled=true
-config rules.ratelimiting.threshold=100

# ====================
# Authentication & Authorization
# ====================
# Test for broken authentication
-config rules.authentication.enabled=true

# Test for authorization bypass
-config rules.authorization.enabled=true

# Test for JWT vulnerabilities
-config rules.jwt.enabled=true

# ====================
# Data Validation
# ====================
# Test for input validation issues
-config rules.inputvalidation.enabled=true

# Test for schema validation
-config rules.schemavalidation.enabled=true
