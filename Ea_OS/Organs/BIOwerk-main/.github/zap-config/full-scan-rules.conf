# OWASP ZAP Full Scan Configuration
# Comprehensive enterprise-grade security testing for BIOwerk

# ====================
# Spider Configuration (Aggressive)
# ====================
-config spider.maxDepth=10
-config spider.maxChildren=20
-config spider.maxDuration=30
-config spider.postform=true
-config spider.parseComments=true
-config spider.parseRobotsTxt=true
-config spider.parseSitemapXml=true
-config spider.parseGit=false
-config spider.processCookies=true
-config spider.sendRefererHeader=true

# ====================
# Active Scan Configuration (Comprehensive)
# ====================
-config ascan.policy=Default Policy
-config ascan.strength=MEDIUM
-config ascan.threadPerHost=5
-config ascan.delayInMs=100
-config ascan.handleAntiCSRFTokens=true

# ====================
# OWASP Top 10 Vulnerability Tests
# ====================

# A01:2021 - Broken Access Control
-config rules.authorization.enabled=true
-config rules.authorization.strength=HIGH

# A02:2021 - Cryptographic Failures
-config rules.crypto.enabled=true
-config rules.weakencryption.enabled=true
-config rules.insufficienttransportlayerprotection.enabled=true

# A03:2021 - Injection
-config rules.sqli.enabled=true
-config rules.sqli.strength=HIGH
-config rules.cmdinjection.enabled=true
-config rules.ldapinjection.enabled=true
-config rules.xmlinjection.enabled=true
-config rules.pathtraversal.enabled=true
-config rules.remotefileinclude.enabled=true

# A04:2021 - Insecure Design
-config rules.insecuredesign.enabled=true

# A05:2021 - Security Misconfiguration
-config rules.securitymisconfiguration.enabled=true
-config rules.servererror.enabled=true
-config rules.privateipdisclosure.enabled=true
-config rules.directorylistingdetection.enabled=true

# A06:2021 - Vulnerable and Outdated Components
-config rules.outdatedcomponents.enabled=true

# A07:2021 - Identification and Authentication Failures
-config rules.authentication.enabled=true
-config rules.sessionmanagement.enabled=true
-config rules.csrf.enabled=true

# A08:2021 - Software and Data Integrity Failures
-config rules.integritycheck.enabled=true

# A09:2021 - Security Logging and Monitoring Failures
-config rules.logging.enabled=true

# A10:2021 - Server-Side Request Forgery (SSRF)
-config rules.ssrf.enabled=true

# ====================
# Additional Security Tests
# ====================

# XSS (Cross-Site Scripting)
-config rules.xss.enabled=true
-config rules.xss.strength=HIGH
-config rules.xssreflected.enabled=true
-config rules.xssstored.enabled=true
-config rules.xssdom.enabled=true

# XXE (XML External Entity)
-config rules.xxe.enabled=true

# CORS (Cross-Origin Resource Sharing)
-config rules.cors.enabled=true

# Security Headers
-config rules.securityheaders.enabled=true
-config rules.hsts.enabled=true
-config rules.xcontenttypeoptions.enabled=true
-config rules.xframeoptions.enabled=true
-config rules.csp.enabled=true

# Information Disclosure
-config rules.informationdisclosure.enabled=true
-config rules.stacktraces.enabled=true
-config rules.creditcard.enabled=true
-config rules.emaildisclosure.enabled=true

# Session Management
-config rules.cookiesecure.enabled=true
-config rules.cookiehttponly.enabled=true
-config rules.cookiesamesite.enabled=true

# API Security
-config rules.apisecurity.enabled=true
-config rules.massassignment.enabled=true
-config rules.excessivedataexposure.enabled=true
-config rules.lackofresourceslimitation.enabled=true

# Business Logic
-config rules.businesslogic.enabled=true

# ====================
# Exclusions (Critical Operations)
# ====================
-config spider.scope.exclude='.*logout.*'
-config spider.scope.exclude='.*delete.*'
-config spider.scope.exclude='.*destroy.*'
-config spider.scope.exclude='.*drop.*'
-config spider.scope.exclude='.*truncate.*'
-config spider.scope.exclude='.*admin/reset.*'
-config spider.scope.exclude='.*admin/destroy.*'

# ====================
# Performance Tuning
# ====================
-config connection.timeoutInSecs=60
-config network.connection.timeoutInSecs=60
